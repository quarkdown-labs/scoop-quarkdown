{
  "version": "1.5.1",
  "description": "A modern Markdown-based typesetting system",
  "homepage": "https://github.com/iamgio/quarkdown",
  "license": "GPL-3.0",
  "depends": [
    "java/openjdk17",
    "nodejs-lts"
  ],
  "url": "https://github.com/iamgio/quarkdown/releases/download/latest/quarkdown.zip",
  "hash": "2a827f657d272e0ca77aee79b8aaccaad165adcaddb6ae3456205660ba26ef0a",
  "extract_dir": "quarkdown",
  "bin": "bin\\quarkdown.bat",
  "post_install": [
    "Set-Item -Path Env:PUPPETEER_CHROME_SKIP_DOWNLOAD -Value 'true'",
    "npm init -y",
    "npm install puppeteer --prefix \"$dir\\lib\"",
    "npm cache verify",
    "Get-ChildItem -Path \"$dir\\lib\"",

    "Remove-Item -Path \"$dir\\bin\\quarkdown\" -Force -ErrorAction SilentlyContinue",
    "Move-Item -Path \"$dir\\bin\\quarkdown.bat\" -Destination \"$dir\\bin\\_quarkdown.bat\"",

    "Set-Content -Path \"$dir\\bin\\quarkdown.bat\" -Value @(",
    "  '@echo off',",
    "  'set APPS_DIR=%~dp0..\\..\\..',",
    "  'set JAVA_HOME=%APPS_DIR%\\openjdk17\\current',",
    "  'set PATH=%APPS_DIR%\\nodejs-lts\\current;%PATH%',",
    "  'set NPM_GLOBAL_PREFIX=%~dp0..\\lib',",
    "  'set NODE_PATH=%NPM_GLOBAL_PREFIX%\\node_modules',",
    "  '\"%~dp0_quarkdown\" %*'",
    ")",
    "Write-Host 'Puppeteer was installed. Make sure Chrome, Chromium or Firefox is installed in order to generate PDF files.'"
  ]
}
