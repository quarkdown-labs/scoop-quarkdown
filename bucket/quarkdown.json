{
  "version": "1.5.1",
  "description": "A modern Markdown-based typesetting system",
  "homepage": "https://github.com/iamgio/quarkdown",
  "license": "GPL-3.0",
  "depends": [
    "java/openjdk17",
    "nodejs-lts"
  ],
  "url": "https://github.com/iamgio/quarkdown/releases/download/latest/quarkdown.zip",
  "hash": "64162fdf569b043d8c0ab9f044c72e07986f81bd9383a75e8d83b08930207366",
  "extract_dir": "quarkdown",
  "bin": "bin\\quarkdown.bat",
  "post_install": [
    "Set-Item -Path Env:PUPPETEER_CHROME_SKIP_DOWNLOAD -Value 'true'",
    "npm install -g puppeteer --prefix \"$dir\\lib\"",

    "Remove-Item -Path \"$dir\\bin\\quarkdown\" -Force -ErrorAction SilentlyContinue",
    "New-Item -ItemType Directory -Force -Path \"$dir\\bin\\internal\"",
    "Move-Item -Path \"$dir\\bin\\quarkdown.bat\" -Destination \"$dir\\bin\\internal\\quarkdown.bat\"",

    "Set-Content -Path \"$dir\\bin\\quarkdown.bat\" -Value @(",
    "  '@echo off',",
    "  'set APPS_DIR=%~dp0..\\..\\..',",
    "  'set JAVA_HOME=%APPS_DIR%\\openjdk17\\current',",
    "  'set PATH=%APPS_DIR%\\nodejs-lts\\current;%PATH%',",
    "  'set NPM_GLOBAL_PREFIX=%~dp0..\\lib',",
    "  '\"%~dp0internal\\quarkdown\" %*'",
    ")",
    "Write-Host 'Puppeteer was installed. Make sure Chrome, Chromium or Firefox is installed in order to generate PDF files.'",
    "Get-Content -Path \"$dir\\bin\\quarkdown.bat\" | ForEach-Object { Write-Host $_; }"
  ]
}
